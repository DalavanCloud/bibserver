{% extends "/base.html" %}

{% block content %}

<script type="text/javascript">
    jQuery(document).ready(function($) {
        $('#panel').facetview( {{ search_options | safe }} )
        var bibserver_collection_delete = function(event) {
            event.preventDefault()
            jQuery.ajax({
                type: "DELETE",
                url: window.location,
                success: function() {
                    alert('Collection deleted')
                    window.location = '/'
                },
                error: function() {
                    alert('Sorry, the deletion failed. Please try again.')
                }
            })
        }
        jQuery('#bibserver_collection_delete').bind('click',bibserver_collection_delete)
    });
</script>
    
    <div id="panel">
        {% if implicit %}
            <h2>{{ implicit }}</h2>
        {% endif %}
        {% if collection.id %}
            <h2><a href="/{{collection.owner}}">{{collection.owner}}</a> / <a href="/{{collection.owner}}/{{collection.collection}}">{{ collection.label }}</a> 
            <small>{{ collection['description'] }}</small></h2>
        {% endif %}
    </div>
{% if collection.id %}
<p>
<a href="/{{collection.owner}}/{{collection.collection}}.json">Download</a> this collection<br />
{% if admin %}
{% if source in collection %}
<a href="/upload?source=%22{{ collection.source }}%22&collection={{collection.collection}}">Refresh</a> this collection (overwrites local changes)<br />
{% endif %}
<a href="">Save current display</a> settings as default for this collection<br />
<a id="bibserver_collection_delete" href="">Delete</a> this collection<br />
</p>
{% endif %}
<p>
{% if source in collection %}
The source of this collection is <a href="{{collection.source}}">{{collection.source}}</a><br />
{% endif %}
{% if _last_modified in collection %}
This collection was last updated on {{collection._last_modified}}
{% endif %}
</p>
{% endif %}

{% endblock %}


